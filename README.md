# üìä Proyecto OLAP con Oracle SQL ‚Äì Informe Completo

## üìù 1. Introducci√≥n
Este proyecto implementa un **sistema OLAP completo en Oracle SQL** a partir de un modelo transaccional OLTP.  
Incluye:

- Creaci√≥n del **modelo estrella (Star Schema)**  
- Implementaci√≥n de **tablas de dimensiones y hechos**  
- Construcci√≥n de un **ETL en PL/SQL**  
- Configuraci√≥n del DBMS (tablespace, usuario OLAP, √≠ndices)  
- Validaci√≥n del proceso  
- Integraci√≥n con Tableau  

Este documento sirve como informe t√©cnico y README del proyecto.

---

# ‚≠ê 2. Modelo OLAP: Star Schema

El modelo anal√≠tico est√° basado en un **esquema estrella**, √≥ptimo para consultas en herramientas BI como Tableau.

---

## üåü 2.1 Diagrama General del Modelo Estrella

DIM_TIEMPO
               (TiempoKey)
                    |
                    |
DIM_CLIENTE ---- FACT_VENTAS ---- DIM_PRODUCTO
(ClienteKey) \ (Hechos) / (ProductoKey)
\ | /
\ | /
---- DIM_UBICACION
(UbicacionKey)
|
|
DIM_EMPLEADO
(EmpleadoKey)


---

## üìö 2.2 Tablas del Modelo Estrella

### ‚úî DIM_PRODUCTO
- ProductoKey (PK)
- ProductoID_OLTP
- NombreProducto
- Categoria
- Proveedor

### ‚úî DIM_CLIENTE
- ClienteKey (PK)
- ClienteID_OLTP
- NombreCliente
- Email

### ‚úî DIM_UBICACION
- UbicacionKey (PK)
- Ciudad
- Provincia
- Pa√≠s

### ‚úî DIM_TIEMPO
- TiempoKey (PK)
- Fecha
- A√±o
- Mes
- Trimestre
- D√≠aSemana
- NombreMes
- NombreDia

### ‚úî DIM_EMPLEADO
- EmpleadoKey (PK)
- EmpleadoID_OLTP
- Nombre
- Cargo

### ‚úî DIM_MODALIDAD_PAGO
- ModalidadKey (PK)
- ModalidadID_OLTP
- Descripcion
- Cuotas

---

# üì¶ 3. Tabla de Hechos: FACT_VENTAS

Incluye:

- TiempoKey  
- ProductoKey  
- ClienteKey  
- UbicacionClienteKey  
- UbicacionProveedorKey  
- EmpleadoKey  
- ModalidadKey  
- Cantidad  
- MontoTotal  
- MontoIVA  
- MontoFinal  

### C√°lculos:

MontoTotal = Cantidad * PrecioUnitario
MontoFinal = MontoTotal + IVA


---

# üõ† 4. Scripts SQL del Esquema OLAP (Oracle)

### üìå 4.1 Crear Tablespace, Usuario y Tablas OLAP

```sql
CREATE TABLESPACE OLAP_DATA
DATAFILE 'olap_data.dbf' SIZE 500M AUTOEXTEND ON;

CREATE USER usuarioolap IDENTIFIED BY olap123;
GRANT CONNECT, RESOURCE TO usuarioolap;
ALTER USER usuarioolap DEFAULT TABLESPACE OLAP_DATA;

CREATE TABLE Dim_Tiempo (
    TiempoKey NUMBER PRIMARY KEY,
    Fecha DATE,
    Anio NUMBER,
    Mes NUMBER,
    Trimestre NUMBER,
    NombreMes VARCHAR2(20),
    DiaSemana NUMBER,
    NombreDia VARCHAR2(20)
) TABLESPACE OLAP_DATA;

CREATE TABLE Dim_Ubicacion (
    UbicacionKey NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    Pais VARCHAR2(50),
    Ciudad VARCHAR2(50)
) TABLESPACE OLAP_DATA;

CREATE TABLE Dim_Producto (
    ProductoKey NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ProductoID_OLTP NUMBER,
    Nombre VARCHAR2(100),
    Categoria VARCHAR2(50),
    Proveedor VARCHAR2(100)
) TABLESPACE OLAP_DATA;

CREATE TABLE Dim_Cliente (
    ClienteKey NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ClienteID_OLTP NUMBER,
    Nombre VARCHAR2(100),
    Email VARCHAR2(100)
) TABLESPACE OLAP_DATA;

CREATE TABLE Dim_Empleado (
    EmpleadoKey NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    EmpleadoID_OLTP NUMBER,
    Nombre VARCHAR2(100),
    Cargo VARCHAR2(50)
) TABLESPACE OLAP_DATA;

CREATE TABLE Dim_ModalidadPago (
    ModalidadKey NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ModalidadID_OLTP NUMBER,
    Descripcion VARCHAR2(100),
    Cuotas NUMBER
) TABLESPACE OLAP_DATA;

CREATE TABLE Fact_Ventas (
    FactID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    TiempoKey NUMBER REFERENCES Dim_Tiempo(TiempoKey),
    UbicacionClienteID NUMBER REFERENCES Dim_Ubicacion(UbicacionKey),
    UbicacionProveedorID NUMBER REFERENCES Dim_Ubicacion(UbicacionKey),
    ProductoKey NUMBER REFERENCES Dim_Producto(ProductoKey),
    ClienteKey NUMBER REFERENCES Dim_Cliente(ClienteKey),
    EmpleadoKey NUMBER REFERENCES Dim_Empleado(EmpleadoKey),
    ModalidadKey NUMBER REFERENCES Dim_ModalidadPago(ModalidadKey),
    Cantidad NUMBER,
    MontoTotal NUMBER(15,2),
    MontoIVA NUMBER(15,2),
    MontoFinal NUMBER(15,2)
) TABLESPACE OLAP_DATA;

```

# 5. Procedimiento ETL en PL/SQL

CREATE OR REPLACE PROCEDURE SP_ETL_CARGAOLAP AS
BEGIN
    -- 1. Cargar Dim Tiempo
    INSERT INTO Dim_Tiempo
    SELECT DISTINCT
        TO_NUMBER(TO_CHAR(Fecha, 'YYYYMMDD')) AS TiempoKey,
        Fecha,
        EXTRACT(YEAR FROM Fecha),
        EXTRACT(MONTH FROM Fecha),
        TO_CHAR(Fecha, 'Q'),
        TO_CHAR(Fecha, 'Month'),
        TO_CHAR(Fecha, 'D'),
        TO_CHAR(Fecha, 'Day')
    FROM Pedido
    WHERE TO_NUMBER(TO_CHAR(Fecha, 'YYYYMMDD')) NOT IN (
        SELECT TiempoKey FROM Dim_Tiempo
    );

    -- 2. Dim Ubicaciones Clientes
    INSERT INTO Dim_Ubicacion (Pais, Ciudad)
    SELECT DISTINCT Pais, Ciudad FROM Cliente
    WHERE (Pais, Ciudad) NOT IN (
        SELECT Pais, Ciudad FROM Dim_Ubicacion
    );

    -- Proveedores
    INSERT INTO Dim_Ubicacion (Pais, Ciudad)
    SELECT DISTINCT Pais, Ciudad FROM Proveedor
    WHERE (Pais, Ciudad) NOT IN (
        SELECT Pais, Ciudad FROM Dim_Ubicacion
    );

    -- 3. Dim Producto
    INSERT INTO Dim_Producto (ProductoID_OLTP, Nombre, Categoria, Proveedor)
    SELECT P.ProductoID, P.Nombre, C.Nombre, PR.Nombre
    FROM Producto P
    JOIN Categoria C ON P.CategoriaID = C.CategoriaID
    JOIN Proveedor PR ON P.ProveedorID = PR.ProveedorID
    WHERE P.ProductoID NOT IN (
        SELECT ProductoID_OLTP FROM Dim_Producto
    );

    -- 4. Dim Cliente
    INSERT INTO Dim_Cliente (ClienteID_OLTP, Nombre, Email)
    SELECT ClienteID, Nombre, Email
    FROM Cliente
    WHERE ClienteID NOT IN (
        SELECT ClienteID_OLTP FROM Dim_Cliente
    );

    -- 5. Dim Empleado
    INSERT INTO Dim_Empleado (EmpleadoID_OLTP, Nombre, Cargo)
    SELECT EmpleadoID, Nombre, Cargo
    FROM Empleado
    WHERE EmpleadoID NOT IN (
        SELECT EmpleadoID_OLTP FROM Dim_Empleado
    );

    -- 6. Dim Modalidad Pago
    INSERT INTO Dim_ModalidadPago (ModalidadID_OLTP, Descripcion, Cuotas)
    SELECT ModalidadPagoID, Descripcion, Cuotas
    FROM ModalidadPago
    WHERE ModalidadPagoID NOT IN (
        SELECT ModalidadID_OLTP FROM Dim_ModalidadPago
    );

    -- 7. Carga FACT_VENTAS (omitido por espacio)
END;
/


# 6. Validaci√≥n del ETL

```sql

SELECT COUNT(*) FROM Fact_Ventas;

SELECT *
FROM Fact_Ventas
ORDER BY FactID DESC
FETCH FIRST 10 ROWS ONLY;

SELECT COUNT(*) FROM Dim_Producto;
SELECT COUNT(*) FROM Dim_Cliente;
SELECT COUNT(*) FROM Dim_Ubicacion;
SELECT COUNT(*) FROM Dim_Tiempo;
SELECT COUNT(*) FROM Dim_Empleado;
```

# 7. Integraci√≥n con Tableau

Pasos:

Abrir Tableau Desktop

Conectar a Oracle

Usuario: usuarioolap

Seleccionar la base de datos OLAP

Arrastrar Fact_Ventas

Tableau detectar√° autom√°ticamente las relaciones

Ejemplo: Producto m√°s vendido por a√±o

Filas: NombreProducto

Columnas: A√±o

Valores: SUM(Cantidad)

Filtro: Ciudad

# 8. Conclusiones

Oracle permite implementar un entorno OLAP completo usando tablespaces, √≠ndices y procedimientos ETL.

El modelo estrella simplifica las consultas anal√≠ticas.

El ETL PL/SQL carga datos incrementalmente y gestiona claves subrogadas.

Tableau aprovecha este modelo para generar visualizaciones profesionales.


MIT License  
Copyright 2025  
Permiso concedido para usar, copiar, modificar y distribuir este software sin restricci√≥n.
